{"version":3,"sources":["webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/loginFn/index.vue?f394","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/loginFn/index.vue?883b","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/loginFn/index.vue?3a9c","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/loginFn/index.vue?53d1","uni-app:///df-components/loginFn/index.vue","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/loginFn/index.vue?7141","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/loginFn/index.vue?cdf2"],"names":["props","isShowLogin","type","required","default","isShowExit","hidePage","toBack","data","ENVANDROID","ENVIOS","methods","loginFn","that","url","userProfileObject","avatarUrl","nickName","province","city","gender","uni","icon","title","success","console","iv","encryptedData","code","sharerObj","sharerStr","avatar","nickname","area","sex","platform","loading","result","token","fail","loginFn_h5","closeFn"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACc;;;AAGlE;AAC+L;AAC/L,gBAAgB,wMAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAiuB,CAAgB,svBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACyFrvB;AAMA;AACA;AAAA;AAAA;AACA;AAAA,eACA;EACAA;IACA;IACAC;MACAC;MACAC;MACAC;IACA;IACA;IACAC;MACAH;MACAE;IACA;IACA;IACAE;MACAJ;MACAE;IACA;IACA;AACA;AACA;AACA;AACA;IACAG;MACAL;MACAE;IACA;EACA;EACAI;IACA;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBAAA,KACAA;kBAAA;kBAAA;gBAAA;gBACAA;gBACAA;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAAA;gBAAA,OAGAD;cAAA;gBAAAE;gBAAA,MAIAA;kBAAA;kBAAA;gBAAA;gBACAC;gBACAC;gBACAC;gBACAC;gBACAC;gBAAA;gBAAA;cAAA;gBAEAC;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAGAF;kBACAG;oBAAA;sBAAA;wBAAA;0BAAA;4BAAA;8BACAC;8BAEAJ;gCACA;gCACAG;kCAAA;oCAAA;oCAAA;sCAAA;wCAAA;0CAAA;4CACAE;4CACAC;4CACAF;4CACA;;4CAEAA;4CAEAG,eAEA;4CACAC;4CACAC;4CACA;8CACAD;4CACA;4CAEArB;8CACAuB;8CACAC;8CACAC;8CACAC;8CAEAC;8CACAP;8CACAF;8CACAC;4CAAA,GAEAE;4CAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;4CAbA;4CAAA,OAeAhB;8CACAuB;8CACAtB;8CACAN;4CACA;0CAAA;4CAJA6B;4CAKAZ;4CAEA;8CACA;gDACAZ;gDAEAyB;gDAEAzB;gDAEAQ;gDAEAA;gDACAA;gDACAR;kDACAQ;kDACAA;oDACAC;oDACAC;kDACA;kDACAV;kDACAA;gDACA;8CACA;gDACAQ;kDACAC;kDACAC;gDACA;8CACA;4CACA;8CACAF;gDACAC;gDACAC;8CACA;4CACA;0CAAA;0CAAA;4CAAA;wCAAA;sCAAA;oCAAA;kCAAA;gCACA;gCACAgB;kCACAd;gCACA;8BACA;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA;oBAAA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAmEAe;MACAf;MACAJ;QACAC;QACAC;MACA;IACA;IACAkB;MACA;MACA;QACA;MACA;IACA;EAyCA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC/XA;AAAA;AAAA;AAAA;AAAo3C,CAAgB,i1CAAG,EAAC,C;;;;;;;;;;;ACAx4C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"df-components/loginFn/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=ca702030&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"df-components/loginFn/index.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=ca702030&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = _vm.isShowLogin ? _vm.getConfigImg(\"dls\") : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view\r\n\t\tclass=\"login-tips-block\"\r\n\t\t:class=\"[hidePage ? 'hidePage' : '']\"\r\n\t\tv-if=\"isShowLogin\"\r\n\t\t@touchmove.stop=\"catchTouchMove\"\r\n\t>\r\n\t\t<view class=\"login-tips border-radius20\">\r\n\t\t\t<view class=\"icon-top-play\"><image :src=\"getConfigImg('dls')\"></image></view>\r\n\t\t\t<view class=\"h4\">您还未登录</view>\r\n\t\t\t<view class=\"h5\">\r\n\t\t\t\t<text>为了完整体验,需要您的授权</text>\r\n\t\t\t\t<text>授权仅用于用户昵称与头像</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- #ifdef MP-WEIXIN -->\r\n\t\t\t<view\r\n\t\t\t\tv-if=\"calcIsOpenSMFlag\"\r\n\t\t\t\t:class=\"['login-btn', isAllAngle ? 'border-radius-style-all-arg' : 'border-radius-style-half-arg']\"\r\n\t\t\t\t@click=\"loginFn\"\r\n\t\t\t\t:style=\"{ background: configInfo.web_site_color }\"\r\n\t\t\t>\r\n\t\t\t\t立即登录\r\n\t\t\t</view>\r\n\t\t\t<button\r\n\t\t\t\tv-else\r\n\t\t\t\t:class=\"['login-btn', isAllAngle ? 'border-radius-style-all-arg' : 'border-radius-style-half-arg']\"\r\n\t\t\t\t@click=\"$onceClick(loginFn, $event)\"\r\n\t\t\t\t:style=\"{ background: configInfo.web_site_color }\"\r\n\t\t\t>\r\n\t\t\t\t立即登录\r\n\t\t\t</button>\r\n\r\n\t\t\t<!-- #endif -->\r\n\r\n\t\t\t<!-- #ifdef APP-PLUS -->\r\n\t\t\t<view\r\n\t\t\t\tv-if=\"appleCheckOpen && appenv == ENVIOS\"\r\n\t\t\t\t:class=\"['login-btn', isAllAngle ? 'border-radius-style-all-arg' : 'border-radius-style-half-arg']\"\r\n\t\t\t\t@click=\"navigateToFn({ url: `/packageA/tel-login/apple-check-open/login` })\"\r\n\t\t\t\t:style=\"{ background: configInfo.web_site_color }\"\r\n\t\t\t>\r\n\t\t\t\t立即登录\r\n\t\t\t</view>\r\n\t\t\t<block v-else>\r\n\t\t\t\t<view\r\n\t\t\t\t\tv-if=\"calcIsOpenSMFlag\"\r\n\t\t\t\t\t:class=\"['login-btn', isAllAngle ? 'border-radius-style-all-arg' : 'border-radius-style-half-arg']\"\r\n\t\t\t\t\t@click=\"androidWxLoginFn\"\r\n\t\t\t\t\t:style=\"{ background: configInfo.web_site_color }\"\r\n\t\t\t\t>\r\n\t\t\t\t\t立即登录\r\n\t\t\t\t</view>\r\n\t\t\t\t<view\r\n\t\t\t\t\tv-else\r\n\t\t\t\t\t:class=\"['login-btn', isAllAngle ? 'border-radius-style-all-arg' : 'border-radius-style-half-arg']\"\r\n\t\t\t\t\t@click=\"androidWxLoginFn\"\r\n\t\t\t\t\t:style=\"{ background: configInfo.web_site_color }\"\r\n\t\t\t\t>\r\n\t\t\t\t\t立即登录\r\n\t\t\t\t</view>\r\n\t\t\t</block>\r\n\t\t\t<!-- #endif -->\r\n\t\t\t<!-- #ifdef H5 -->\r\n\t\t\t<button\r\n\t\t\t\t:class=\"['login-btn', isAllAngle ? 'border-radius-style-all-arg' : 'border-radius-style-half-arg']\"\r\n\t\t\t\t:style=\"{ background: configInfo.web_site_color }\"\r\n\t\t\t\t@click=\"gzhH5WxloginFn\"\r\n\t\t\t>\r\n\t\t\t\t立即登录\r\n\t\t\t</button>\r\n\r\n\t\t\t<!-- #endif -->\r\n\t\t\t<navigator\r\n\t\t\t\tv-if=\"isShowExit\"\r\n\t\t\t\thover-class=\"none\"\r\n\t\t\t\ttarget=\"miniProgram\"\r\n\t\t\t\topen-type=\"exit\"\r\n\t\t\t\tclass=\"say-no\"\r\n\t\t\t\t:style=\"{ color: configInfo.web_site_color }\"\r\n\t\t\t>\r\n\t\t\t\t退出\r\n\t\t\t</navigator>\r\n\t\t\t<text v-else class=\"say-no\" @click=\"closeFn\" :style=\"{ color: configInfo.web_site_color }\">暂不登录</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n\t// 当前运行环境 安卓 or 苹果\r\n\tENVANDROID,\r\n\tENVIOS\r\n} from '@/tools/const.js';\r\n\r\nimport { en2ch, assertObject, assertString } from '@/tools/tools';\r\nimport { host } from '@/tools/siteinfo.js';\r\nlet timer;\r\nexport default {\r\n\tprops: {\r\n\t\t// 是否显示 登录框 组件\r\n\t\tisShowLogin: {\r\n\t\t\ttype: Boolean,\r\n\t\t\trequired: true,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\t// 是否显示 退出小程序按钮 (显示退出 就不显示 取消了  用在转发页面必须登录)\r\n\t\tisShowExit: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\t// 登录框显示时 是否隐藏页面是所有元素\r\n\t\thidePage: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\t/* \n\t\t\t@description\n\t\t\t\ttoBack默认false\n\t\t\t\t当 toBack 是 true时 表示 用户点击暂不登录 就返回上一页面\n\t\t*/\r\n\t\ttoBack: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tENVANDROID,\r\n\t\t\tENVIOS\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t// 小程序 登录功能\r\n\t\tasync loginFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tif (that.calcIsOpenSMFlag) {\r\n\t\t\t\tthat.closeGlobalLoginFn(false);\r\n\t\t\t\tthat.navigateToFn({\r\n\t\t\t\t\turl: `/packageA/tel-login/tel-login`\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tlet userProfileObject = await that.getUserProfileFn();\r\n\r\n\t\t\tlet avatarUrl, nickName, province, city, gender;\r\n\r\n\t\t\tif (userProfileObject.type == 'success') {\r\n\t\t\t\tavatarUrl = userProfileObject.result.avatarUrl;\r\n\t\t\t\tnickName = userProfileObject.result.nickName;\r\n\t\t\t\tprovince = userProfileObject.result.province;\r\n\t\t\t\tcity = userProfileObject.result.city;\r\n\t\t\t\tgender = userProfileObject.result.gender;\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\ttitle: '获取个人信息失败'\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tuni.login({\r\n\t\t\t\tasync success(e) {\r\n\t\t\t\t\tconsole.log('先获取code那堆数据', e);\r\n\r\n\t\t\t\t\tuni.getUserInfo({\r\n\t\t\t\t\t\t//获取用户信息\r\n\t\t\t\t\t\tasync success(userInfoRes) {\r\n\t\t\t\t\t\t\tlet iv = encodeURIComponent(userInfoRes.iv);\r\n\t\t\t\t\t\t\tlet encryptedData = encodeURIComponent(userInfoRes.encryptedData);\r\n\t\t\t\t\t\t\tconsole.log('uni.getUserInfo 成功的数据', userInfoRes, '\\n');\r\n\t\t\t\t\t\t\t//第一次提示用户授权 成功后的回调 授权后再点直接成功 拿回来用户信息\r\n\r\n\t\t\t\t\t\t\tconsole.log('后获取用户信息 包括iv 和 xxxdata字符串', userInfoRes);\r\n\r\n\t\t\t\t\t\t\tlet code = e.code;\r\n\r\n\t\t\t\t\t\t\t// 登录时 把分享者的字符串带上\r\n\t\t\t\t\t\t\tlet sharerObj = {};\r\n\t\t\t\t\t\t\tlet sharerStr = uni.getStorageSync('sharer'); // 带上分享上级的加密字符串\r\n\t\t\t\t\t\t\tif (sharerStr) {\r\n\t\t\t\t\t\t\t\tsharerObj.sharer = sharerStr;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\t\t\tavatar: avatarUrl,\r\n\t\t\t\t\t\t\t\tnickname: nickName,\r\n\t\t\t\t\t\t\t\tarea: `${en2ch(province)}-${en2ch(city)}`,\r\n\t\t\t\t\t\t\t\tsex: gender,\r\n\r\n\t\t\t\t\t\t\t\tplatform: 'wechat_applet',\r\n\t\t\t\t\t\t\t\tcode,\r\n\t\t\t\t\t\t\t\tiv,\r\n\t\t\t\t\t\t\t\tencryptedData,\r\n\r\n\t\t\t\t\t\t\t\t...sharerObj\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t/* \n\t\t\t\t\t\t\t let oo = JSON.stringify(data);\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t console.log(`\n\t\t\t\t\t\t\t \t/api/User/third 接口参数信息\n\t\t\t\t\t\t\t \t\n\t\t\t\t\t\t\t \t-----------------------------------\n\t\t\t\t\t\t\t \t${oo}\n\t\t\t\t\t\t\t \t-----------------------------------\n\t\t\t\t\t\t\t \t${data}\n\t\t\t\t\t\t\t `);\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t return false;\n\t\t\t\t\t\t\t */\r\n\r\n\t\t\t\t\t\t\tlet result = await that.$request({\r\n\t\t\t\t\t\t\t\tloading: true,\r\n\t\t\t\t\t\t\t\turl: '/api/User/third',\r\n\t\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log('用户登录时带的参数', data, '\\n', '返回的结果', result, '\\n');\r\n\r\n\t\t\t\t\t\t\tif (result.statusCode == 200) {\r\n\t\t\t\t\t\t\t\tif (result.data.code == 200) {\r\n\t\t\t\t\t\t\t\t\tthat.logOutFn(); // 先退出登录一下\r\n\r\n\t\t\t\t\t\t\t\t\tlet token = assertObject(result.data.data).token;\r\n\r\n\t\t\t\t\t\t\t\t\tthat.$store.commit('setToken', token);\r\n\r\n\t\t\t\t\t\t\t\t\tuni.setStorageSync('token', token);\r\n\r\n\t\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\t\tuni.showLoading({});\r\n\t\t\t\t\t\t\t\t\tthat.hasTokenGetUserInfo(() => {\r\n\t\t\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: '登录成功'\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tthat.$emit('loginSuccessCallback');\r\n\t\t\t\t\t\t\t\t\t\tthat.closeGlobalLoginFn(false);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\ttitle: result.data.msg\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\ttitle: that.$errorMsg\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(e) {\r\n\t\t\t\t\t\t\tconsole.log('登录失败 小程序 getUserInfo 接口fail ', e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// #ifdef APP-PLUS\r\n\r\n\t\t// 安卓 微信登录\r\n\t\tasync androidWxLoginFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tif (that.calcIsOpenSMFlag) {\r\n\t\t\t\tthat.closeGlobalLoginFn(false);\r\n\t\t\t\tthat.navigateToFn({\r\n\t\t\t\t\turl: `/packageA/tel-login/tel-login`\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tlet userInfoResult = await that.getLoginDataFn(); // 获取用户信息 开始登录\r\n\r\n\t\t\tif (userInfoResult.type == 'success') {\r\n\t\t\t\tconsole.log('登录需要的参数', userInfoResult.result);\r\n\r\n\t\t\t\tlet result = await that.$request({\r\n\t\t\t\t\tloading: true,\r\n\t\t\t\t\turl: '/api/User/third',\r\n\t\t\t\t\tdata: userInfoResult.result\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log('用户登录时带的参数', userInfoResult.result, '\\n', '返回的结果', result, '\\n');\r\n\r\n\t\t\t\tif (result.statusCode == 200) {\r\n\t\t\t\t\tif (result.data.code == 200) {\r\n\t\t\t\t\t\tthat.logOutFn(); // 先退出登录一下\r\n\r\n\t\t\t\t\t\tlet token = assertObject(result.data.data).token;\r\n\r\n\t\t\t\t\t\tthat.$store.commit('setToken', token);\r\n\r\n\t\t\t\t\t\tuni.setStorageSync('token', token);\r\n\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tuni.showLoading({});\r\n\t\t\t\t\t\tthat.hasTokenGetUserInfo(() => {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\ttitle: '登录成功'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.$emit('loginSuccessCallback');\r\n\t\t\t\t\t\t\tthat.closeGlobalLoginFn(false);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\ttitle: result.data.msg\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\ttitle: that.$errorMsg\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\ttitle: userInfoResult.msg\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\t// #endif\r\n\t\tloginFn_h5() {\r\n\t\t\tconsole.log('0');\r\n\t\t\tuni.showToast({\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\ttitle: '未接入开放平台'\r\n\t\t\t});\r\n\t\t},\r\n\t\tcloseFn() {\r\n\t\t\tthis.$emit('close');\r\n\t\t\tif (this.toBack) {\r\n\t\t\t\tthis.toBackFn();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// #ifdef H5\r\n\t\tgzhH5WxloginFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tif (that.calcIsOpenSMFlag) {\r\n\t\t\t\tthat.closeGlobalLoginFn(false);\r\n\t\t\t\tthat.navigateToFn({\r\n\t\t\t\t\turl: `/packageA/tel-login/tel-login`\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (that.globalBrowserIsWx) {\r\n\t\t\t\tlet h5path = encodeURIComponent(`${host}/h5/#/pages/my/my`); // 获取完token再跳回到 h5 的路径\r\n\t\t\t\tlet href = `${host}/api/User/third?platform=officialAccount&path=${h5path}`;\r\n\r\n\t\t\t\t// 登录时 把分享者的字符串带上\r\n\t\t\t\tlet sharerStr = uni.getStorageSync('sharer'); // 带上分享上级的加密字符串\r\n\t\t\t\tif (sharerStr) {\r\n\t\t\t\t\thref += `&sharer=${sharerStr}`;\r\n\t\t\t\t}\r\n\t\t\t\tlocation.href = href;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tuni.showModal({\r\n\t\t\t\tshowCancel: false, //不显示取消按钮\r\n\t\t\t\ttitle: '平台未开通短信登录,请在微信内打开',\r\n\t\t\t\tsuccess(e) {\r\n\t\t\t\t\t//确认后的回调\r\n\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t\tlet xcxUrl = assertObject(that.configInfo).h5_applet_url;\r\n\t\t\t\t\tif (assertString(xcxUrl)) {\r\n\t\t\t\t\t\tlet tagA = document.createElement('a');\r\n\t\t\t\t\t\ttagA.href = xcxUrl;\r\n\t\t\t\t\t\ttagA.click();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t// #endif\r\n\t}\r\n\t// ↑↑↑↑↑ methods 结束\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.login-tips-block {\r\n\tposition: fixed;\r\n\tz-index: 990;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\tbackground: rgba(0, 0, 0, 0.3);\r\n\r\n\t&.hidePage {\r\n\t\tbackground: #a9a9a9;\r\n\t}\r\n\r\n\t.login-tips {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tmargin: auto;\r\n\t\twidth: 600rpx;\r\n\t\theight: 600rpx;\r\n\t\tbackground: #ffffff;\r\n\r\n\t\t.icon-top-play {\r\n\t\t\timage {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tleft: 50%;\r\n\t\t\t\ttransform: translateX(-50%) translateY(-50%);\r\n\t\t\t\twidth: 280rpx;\r\n\t\t\t\theight: 280rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.h4 {\r\n\t\t\tmargin-top: 175rpx;\r\n\t\t\ttext-align: center;\r\n\t\t\tfont-weight: 600;\r\n\t\t\tcolor: $grey1-color;\r\n\t\t\tfont-size: 36rpx;\r\n\t\t}\r\n\r\n\t\t.h5 {\r\n\t\t\tmargin-top: 40rpx;\r\n\t\t\tcolor: $grey1-color;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\ttext-align: center;\r\n\r\n\t\t\ttext {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tline-height: 50rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.say-no,\r\n\t\t.login-btn {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\tmargin: 35rpx auto 0;\r\n\t\t\twidth: 536rpx;\r\n\t\t\theight: 88rpx;\r\n\t\t\tcolor: #ffffff;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t}\r\n\r\n\t\t.login-btn {\r\n\t\t\tborder-radius: 14rpx;\r\n\t\t}\r\n\r\n\t\t.say-no {\r\n\t\t\tmargin-top: 10rpx;\r\n\t\t\tbackground: transparent;\r\n\t\t\ttext-decoration: underline;\r\n\t\t}\r\n\t}\r\n}\r\n</style>\n","import mod from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1675502567575\n      var cssReload = require(\"E:/HBuilderX.2.6.9.20200403/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}