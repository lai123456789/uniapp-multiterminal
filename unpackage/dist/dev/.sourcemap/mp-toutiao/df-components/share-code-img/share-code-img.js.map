{"version":3,"sources":["webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/share-code-img/share-code-img.vue?9b24","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/share-code-img/share-code-img.vue?465a","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/share-code-img/share-code-img.vue?987d","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/share-code-img/share-code-img.vue?9a33","uni-app:///df-components/share-code-img/share-code-img.vue","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/share-code-img/share-code-img.vue?d3b9","webpack:///F:/test-uniapp2/万象优鲜商城生鲜配送系统生鲜批发版本APP小程序公众号抖音小程序快手商城小程序/df-components/share-code-img/share-code-img.vue?0b0c"],"names":["str","arr","currentSize","canvasHeight","avatarSize","codeSize","codeX","codeY","goodsImgX","goodsImgY","goodsSize","showImgW","showImgH","components","openSetting","props","goodsId","type","goodsName","default","goodsImgs","isRob","path","imgIndex","goodsType","goodsPrice","data","canvasWidth","temPathArr","avatar","code","bg","avatarCode","currentImg","shareImgPath","isShowModule","isShowOpenSetting","methods","canvasCreateImgFn","that","uni","title","success","e","url","avatarSrc","gbImgSrc","msg","console","shareCodeImgHttpSrc","imgArr","Promise","then","catch","pc2pxFn","shareAppPageFn","pageTypeObj","query","scene","goods_id","options","imageUrl","cloneSettingFn","cloneModuleFn","failFn","icon","getShareCodeImgFn","method","id","result","resFn","rejFn","clipArcAvatarFn","ctx","imgW","imgH","imgPath","saveAvatarFn","canvasId","fail","createSharImgFn","bgImgSrc","avatarX","avatarY","goodsNameArr","goodsNameLineHeight","item","priceText","getAvatarInfo","avatarMargin","showShareImgFn","saveShearImgFn","saveImgFn","settingInfo","src","filePath","saveImgAppFn","computed","userInfoAvatar","userInfoEncrypt"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuI;AACvI;AACkE;AACL;AACsC;;;AAGnG;AAC+L;AAC/L,gBAAgB,wMAAU;AAC1B,EAAE,oFAAM;AACR,EAAE,qGAAM;AACR,EAAE,8GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,oPAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC1CA;AAAA;AAAA;AAAA;AAA0uB,CAAgB,+vBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACoF9vB;AAIA;AACA;AAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAEA;;AAEA;AACA;AACA;AACA;AACA;EAAA;EACA;EACA;EACA;EACA;EAEA;IACAA;IACA;MACAC;MACAD;MACAE;IACA;EACA;EACA;IACAD;EACA;EACA;AACA;AAEA;EACAE;EACAC;EACA;EACAC;EAAA;EACAC;EAAA;EACAC;EAAA;EACAC;EACAC;EACAC;EACAC;EACAC;AAAA,eAEA;EACAC;IACAC;EACA;EACAC;IACAC;MACAC;IACA;IACAC;MACAD;MACAE;IACA;IACAC;MACAH;IACA;IACAI;MACAJ;MACAE;IACA;IACAG;MACAL;IACA;IACA;IACAM;MACAJ;IACA;IAEA;AACA;AACA;AACA;AACA;AACA;IACAK;MACAP;MACAE;IACA;IACAM;MACAR;IACA;EACA;EACAS;IACA;MACAC;MACAxB;MAEAC;MAEA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;;MAEAC;MACAC;MACAC;MAEAC;MACAC;MAEA;MACAgB;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;MACA;;MACAC;MAEAC;MACAC;IACA;EACA;EACAC;IAgBA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBAAA,IACAA;kBAAA;kBAAA;gBAAA;gBACAA;gBAAA,iCACA;cAAA;gBAAA,IAIAA;kBAAA;kBAAA;gBAAA;gBACAC;kBACAC;kBACAC;oBACAC;sBAAAC;oBAAA;kBACA;gBACA;gBAAA,iCACA;cAAA;gBAQAjB;gBAEAkB,iCAGAC;gBACA;AACA;AACA;AACA;;AAEA;gBALA,IAOAA;kBAAA;kBAAA;gBAAA;gBACAP;kBACAQ;gBACA;gBAAA,iCACA;cAAA;gBAGAR;gBAAA,KAEAA;kBAAA;kBAAA;gBAAA;gBAAA,iCACA;cAAA;gBAEAS;gBACA;gBAAA;gBAAA,OACAT;cAAA;gBAAAU;gBAEA;kBACAD;kBACA;kBACAT;kBACAA;kBAEAA;kBACAA;kBAEAA;kBAEAA;kBACAA;kBACAA;kBAEAA;kBACAA;kBACAA;kBAEAA;kBACAA;kBAEAhB;kBAEAyB,YACA,uDACAT,oBACAA,oBACA;kBACAS,oIAMAC,sLAOAJ,2KAOAC,gLAOAI,yIAQA;kBAEAC,aACA,qDACA,oCACA,mCACA,8CACA,EACAC;oBACA;oBACAb;oBACAA;oBACAA;oBACAA;oBAEAS,YACAT,iBACA,YACA,MACAA,sBACAA,wBACAA,oBACAA,2BACA;oBAEAA;kBACA,GACAc;oBACAL;oBACAT;sBACAQ;oBACA;kBACA;kBAEAC,YACAC,4BACA,MACAJ,WACA,MACAC,UACA,MACAI,sBACA,KACA;kBAEAF;gBACA;kBACAT;oBACAQ;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAO;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;QACAC;MACA;MACAjB;QACAjB;QACAmC;UACAC;UAAA;UACAC;QAAA,GACAH,YACA;QACAI;UACAnB;UACAoB;QACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACAxB;MACAA;QACAyB;QACAxB;MACA;IACA;IAEA;IACAyB;MACA;MACA;MACA;QAAA7C;MACA2B;MAEA;QAAA;UAAA;UAAA;YAAA;cAAA;gBAAA;kBAAA;kBAAA,OACAT;oBACAK;oBACAuB;oBACAzC;sBACAJ;sBACA8C;sBACA/C;oBACA;kBACA;gBAAA;kBARAgD;kBASA;oBACA;sBACAC;wBACArD;wBACA8B;wBACAsB;sBACA;oBACA;sBACAE;wBACAtD;wBACA8B;wBACAsB;sBACA;oBACA;kBACA;oBACAE;sBACAtD;sBACA8B;sBACAsB;oBACA;kBACA;gBAAA;gBAAA;kBAAA;cAAA;YAAA;UAAA;QAAA,CACA;QAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAG;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAjC,eACA;gBACAkC,qDAEA;gBACAC,wBACAC,wBACAC;gBAEAH;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;;gBAEAzB;gBAEAA;gBAEAyB;kBACAzB;kBACA;kBACAT;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAsC;MACA;MACA;MACArC,yBACA;QACAsC;QACApC;UACA;UAEAH;UAEAS;UACAT;QACA;QACAwC;UACAxC;YACAQ;UACA;QACA;MACA,GACAR,KACA;IACA;IACA;IACAyC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAzC;gBACA0C,+BAEA;gBACAR,sDACA;gBAEA;gBACAC,2BACAC,4BACAC,oBAEA;gBACAH;gBACA;kBACA;kBACA;kBACA;oBACAE;oBACAC;kBAEAH;kBAEAA;kBACA;;kBAEA;oBAAArE;oBAAA8E;oBAAAC;kBAEAV;kBACAA;kBACAA;kBAEAA,cACAlC,4BACA2C,0BACAC,0BACA/E,YACAA,WACA;kBAEA;oBACA;oBACA;sBACAuE;sBACAC;oBAEAH;oBAEAA;oBACAA;oBAEA;oBAEAzB;oBAEA;sBACAoC;oBACA;oBACA;sBACAC;oBAEAD;sBACA;wBACAX,aACAa,MACA/C,kBACAA,yDACA;wBACA;sBACA;oBACA;;oBAEA;oBACA;sBACAgD;oBACA;sBACAA;oBACA;sBACAA;oBACA;oBACAd;oBACAA;oBACAA;oBAEAA;sBACAlC;oBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAiD;MACA;MACA;QAAA;QACAC;QAAA;QACAP;QAAA;QACAC;MACA;QACA/E;QACA8E;QACAC;MACA;IACA;IAEA;IACAO;MACA;MACA;MACAlD,yBACA;QACAsC;QACApC;UACA;UAEAH;UAEAS;QACA;QACA+B;UACAxC;YACAQ;UACA;QACA;MACA,GACAR,KACA;IACA;IACA;IACAoD;MACA;MACA3C;MACA;QACA;MACA;IASA;IACA;IACA4C;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACArD,eACA;gBAAA;gBAAA,OACAA;cAAA;gBAAAsD;gBACA7C;gBAEA;kBACA;kBACA;oBACA;oBACA;;oBAEAT;oBACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;kBACA;kBACA;kBACA;oBACAC;sBACAsD;sBACApD;wBACAF;0BACAuD;0BACArD;4BACAF;8BACAyB;8BACAxB;4BACA;0BACA;0BACAsC;4BACAvC;8BACAyB;8BACAxB;4BACA;0BACA;wBACA;sBACA;sBACAsC;wBACA/B;sBACA;oBACA;kBACA;gBACA;kBACAR;oBACAyB;oBACAxB;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAuD;MAAA;QAAA;UAAA;YAAA;cAAA;gBACAxD;kBACAsD;kBACApD;oBACAF;sBACAuD;sBACArD;wBACAF;0BACAyB;0BACAxB;wBACA;sBACA;sBACAsC;wBACAvC;0BACAyB;0BACAxB;wBACA;sBACA;oBACA;kBACA;kBACAsC;oBACA/B;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;EACA;EACAiD,4BACA;IACAC;MAAA;IAAA;IAAA;IACAC;MAAA;IAAA;EACA;AAGA;AAAA,2B;;;;;;;;;;;;;ACvvBA;AAAA;AAAA;AAAA;AAAq5C,CAAgB,k3CAAG,EAAC,C;;;;;;;;;;;ACAz6C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"df-components/share-code-img/share-code-img.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./share-code-img.vue?vue&type=template&id=19bebe3a&scoped=true&\"\nvar renderjs\nimport script from \"./share-code-img.vue?vue&type=script&lang=js&\"\nexport * from \"./share-code-img.vue?vue&type=script&lang=js&\"\nimport style0 from \"./share-code-img.vue?vue&type=style&index=0&id=19bebe3a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"19bebe3a\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"df-components/share-code-img/share-code-img.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share-code-img.vue?vue&type=template&id=19bebe3a&scoped=true&\"","var components\ntry {\n  components = {\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"components/uni-icons/uni-icons\" */ \"@/components/uni-icons/uni-icons.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = _vm.calcImageSrc(\"/global-image/share-icon_goods-info.png\")\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share-code-img.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share-code-img.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"share-code-wrap\">\r\n\t\t<view class=\"hide-canvas-dom\">\r\n\t\t\t<canvas\r\n\t\t\t\tclass=\"sharImgCanvas\"\r\n\t\t\t\t:style=\"{ width: canvasWidth + 'px', height: canvasHeight + 'px' }\"\r\n\t\t\t\tcanvas-id=\"sharImgCanvas\"\r\n\t\t\t></canvas>\r\n\t\t\t<canvas\r\n\t\t\t\tclass=\"avatarCanvas\"\r\n\t\t\t\t:style=\"{ width: avatarSize + 'px', height: avatarSize + 'px' }\"\r\n\t\t\t\tcanvas-id=\"avatarCanvas\"\r\n\t\t\t></canvas>\r\n\t\t</view>\r\n\t\t<view class=\"btn-default\" @click=\"canvasCreateImgFn\">\r\n\t\t\t<image class=\"share-icon_goods-info\" :src=\"calcImageSrc('/global-image/share-icon_goods-info.png')\"></image>\r\n\t\t\t<view class=\"text\">分享</view>\r\n\t\t</view>\r\n\t\t<view v-show=\"isShowModule\" :class=\"['bg-module']\"></view>\r\n\r\n\t\t<view :class=\"['block-dom', isShowModule ? 'act' : '']\">\r\n\t\t\t<view class=\"img-wrap\" @click=\"cloneModuleFn()\">\r\n\t\t\t\t<image\r\n\t\t\t\t\tv-if=\"shareImgPath\"\r\n\t\t\t\t\t:src=\"shareImgPath\"\r\n\t\t\t\t\t:style=\"{ width: showImgW + 'px', height: showImgH + 'px' }\"\r\n\t\t\t\t\t@click.stop=\"catchTouchMove\"\r\n\t\t\t\t></image>\r\n\t\t\t\t<view class=\"loading-wrap\" v-else>\r\n\t\t\t\t\t<view class=\"animate-rotate-dom\">\r\n\t\t\t\t\t\t<view class=\"box box1\">\r\n\t\t\t\t\t\t\t<view class=\"dot dot1\"></view>\r\n\t\t\t\t\t\t\t<view class=\"dot dot2\"></view>\r\n\t\t\t\t\t\t\t<view class=\"dot dot3\"></view>\r\n\t\t\t\t\t\t\t<view class=\"dot dot4\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"box box2\">\r\n\t\t\t\t\t\t\t<view class=\"dot dot1\"></view>\r\n\t\t\t\t\t\t\t<view class=\"dot dot2\"></view>\r\n\t\t\t\t\t\t\t<view class=\"dot dot3\"></view>\r\n\t\t\t\t\t\t\t<view class=\"dot dot4\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"text\">海报生成中</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"btn-group-block\">\r\n\t\t\t\t<!-- #ifdef MP-WEIXIN -->\r\n\r\n\t\t\t\t<!-- iconfont icon-weixin -->\r\n\t\t\t\t<button class=\"icon-item clear-btn-style\" open-type=\"share\">\r\n\t\t\t\t\t<view class=\"icon-block- icon-weixin-\">\r\n\t\t\t\t\t\t<uni-icons type=\"weixin\" size=\"30\" color=\"#ffffff\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"icon-txt\">分享好友</view>\r\n\t\t\t\t</button>\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t\t<!-- #ifdef APP-PLUS -->\r\n\t\t\t\t<button class=\"icon-item clear-btn-style\" @click=\"shareAppPageFn\">\r\n\t\t\t\t\t<view class=\"icon-block- icon-weixin-\">\r\n\t\t\t\t\t\t<uni-icons type=\"weixin\" size=\"30\" color=\"#ffffff\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"icon-txt\">分享好友</view>\r\n\t\t\t\t</button>\r\n\t\t\t\t<!-- #endif -->\r\n\r\n\t\t\t\t<view class=\"icon-item\" @click=\"saveShearImgFn()\">\r\n\t\t\t\t\t<view class=\"icon-block- icon-load\">\r\n\t\t\t\t\t\t<uni-icons type=\"upload-filled\" size=\"26\" color=\"#ffffff\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"icon-txt\">保存海报</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<open-setting\r\n\t\t\t:is-show=\"isShowOpenSetting\"\r\n\t\t\t@cloneFn=\"cloneSettingFn\"\r\n\t\t\ttitle=\"打开允许保存到相册设置\"\r\n\t\t></open-setting>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n    mapState\r\n} from 'vuex'\r\n\r\nimport { url2temPath, transNumFn } from '@/tools/tools';\r\nimport { bindMobileTips } from '@/tools/const.js';\r\nimport openSetting from '@/df-components/openSetting/openSetting';\r\nlet timer;\r\n\r\n/* \r\n\t\t防止商品名称太长 顶出去 以10个字 为一组 开始画\r\n\t\t传入商品名称 返回 数组\r\n\t*/\r\nfunction getTextListFn(goodsNameStr, len = 10) {\r\n\tlet arr = [];\r\n\tlet size = len;\r\n\tlet currentSize = len;\r\n\tlet str = '';\r\n\r\n\tfor (let i = 0; i < goodsNameStr.length; i++) {\r\n\t\tstr += goodsNameStr[i];\r\n\t\tif (i == currentSize - 1) {\r\n\t\t\tarr.push(str);\r\n\t\t\tstr = '';\r\n\t\t\tcurrentSize += size;\r\n\t\t}\r\n\t}\r\n\tif (str.length > 0) {\r\n\t\tarr.push(str);\r\n\t}\r\n\treturn arr;\r\n}\r\n\r\nconst canvasWidth = 750,\r\n\tcanvasHeight = 1136,\r\n\tavatarSize = 90,\r\n\t// 二维码信息\r\n\tcodeSize = 194, //二维码尺寸\r\n\tcodeX = 490, //二维码x坐标\r\n\tcodeY = 852, //二维码y坐标\r\n\tgoodsImgX = 66,\r\n\tgoodsImgY = 210,\r\n\tgoodsSize = 620,\r\n\tshowImgW = 576,\r\n\tshowImgH = 876;\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\topenSetting\r\n\t},\r\n\tprops: {\r\n\t\tgoodsId: {\r\n\t\t\ttype: [String, Number]\r\n\t\t},\r\n\t\tgoodsName: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tgoodsImgs: {\r\n\t\t\ttype: Array\r\n\t\t},\r\n\t\tisRob: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tpath: {\r\n\t\t\ttype: String\r\n\t\t},\r\n\t\t// imgIndex 轮播图展示 当前图片的 索引\r\n\t\timgIndex: {\r\n\t\t\tdefault: 1\r\n\t\t},\r\n\r\n\t\t/* \r\n\t\t\t商品的类型  \r\n\t\t\t\tjifen  积分兑换\r\n\t\t\t\tpintuan  拼团商品\r\n\t\t\t\tdefault  默认的 普通商品 和 秒杀商品\r\n\t\t*/\r\n\t\tgoodsType: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'default'\r\n\t\t},\r\n\t\tgoodsPrice: {\r\n\t\t\ttype: [String, Number]\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcanvasWidth: 750,\r\n\t\t\tcanvasHeight: 1136,\r\n\r\n\t\t\tavatarSize: 90,\r\n\r\n\t\t\t// 二维码信息\r\n\t\t\tcodeSize: 194, //二维码尺寸\r\n\t\t\tcodeX: 46, //二维码x坐标\r\n\t\t\tcodeY: 730, //二维码y坐标\r\n\r\n\t\t\tgoodsImgX: 30,\r\n\t\t\tgoodsImgY: 24,\r\n\t\t\tgoodsSize: 696,\r\n\r\n\t\t\tshowImgW: 430,\r\n\t\t\tshowImgH: 542,\r\n\r\n\t\t\t//存放临时路径的对象\r\n\t\t\ttemPathArr: {\r\n\t\t\t\tavatar: '', //头像\r\n\t\t\t\tcode: '', //初始二维码\r\n\t\t\t\tbg: '', //背景图片\r\n\t\t\t\tavatarCode: '', //头像二维码 (剪切圆形的头像本地地址)\r\n\t\t\t\tcurrentImg: '' // 当前轮播图显示的图片的临时路径\r\n\t\t\t},\r\n\t\t\tshareImgPath: '',\r\n\r\n\t\t\tisShowModule: false,\r\n\t\t\tisShowOpenSetting: false\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t// #ifdef H5\r\n\t\t// 浏览器端复制当前商品地址\r\n\t\th5GzhShareGoodsFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tconst shareUrlStr = `${location.origin}${location.pathname}${location.hash}&shareFn=true&scene=${\r\n\t\t\t\tthat.userInfoEncrypt\r\n\t\t\t}`;\r\n\t\t\tthat.copyStrFn(shareUrlStr, () => {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\ttitle: '复制商品链接成功'\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\t// #endif\r\n\t\t// canvas生成图片_1\r\n\t\tasync canvasCreateImgFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tif (!that.isLogin) {\r\n\t\t\t\tthat.closeGlobalLoginFn(true);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 未绑定手机号不能操作以下功能\r\n\t\t\tif(!that.isRunBindMobileFunc){\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: bindMobileTips,\r\n\t\t\t\t\tsuccess(e) {\r\n\t\t\t\t\t\te.confirm && that.navigateToFn({url: `/packageA/tel-login/user-info`});\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// #ifdef H5\r\n\t\t\tthat.h5GzhShareGoodsFn();\r\n\t\t\treturn false;\r\n\t\t\t// #endif\r\n\r\n\t\t\tlet { canvasWidth, canvasHeight, goodsImgs: imgArr } = that;\r\n\r\n\t\t\tlet avatarSrc = that.userInfoAvatar, //头像地址\r\n\t\t\t\t// gbImgSrc = that.calcImageSrc('/global-image/goods_shear_code_bg.jpg'); //背景图地址\r\n\t\t\t\t// gbImgSrc = `http://192.168.1.10:8080/bg.jpg`; //背景图地址\r\n\t\t\t\tgbImgSrc = that.addimgPathHostFn(that.configInfo.de_share_back_img); //背景图地址\r\n\t\t\t/* \r\n\t\t\t\t console.log(\r\n\t\t\t\t     '后台设置的背景图片',gbImgSrc\r\n\t\t\t\t );\r\n\t\t\t\t \r\n\t\t\t\t*/\r\n\r\n\t\t\tif (!gbImgSrc) {\r\n\t\t\t\tthat.failFn({\r\n\t\t\t\t\tmsg: '未设置海报背景图片'\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthat.isShowModule = true;\r\n\r\n\t\t\tif (that.shareImgPath) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tconsole.log(that.isShowModule, 'that.isShowModule', '\\n');\r\n\t\t\t// 获取分享二维码图片链接\r\n\t\t\tlet shareCodeImgHttpSrc = await that.getShareCodeImgFn();\r\n\r\n\t\t\tif (shareCodeImgHttpSrc.type == 'success') {\r\n\t\t\t\tconsole.log('转换前的 尺寸', canvasWidth, canvasHeight);\r\n\t\t\t\t// 处理坐标\r\n\t\t\t\tthat.canvasWidth = that.pc2pxFn(canvasWidth);\r\n\t\t\t\tthat.canvasHeight = that.pc2pxFn(canvasHeight);\r\n\r\n\t\t\t\tthat.canvasBgWidth = that.pc2pxFn(canvasWidth);\r\n\t\t\t\tthat.canvasBgHeight = that.pc2pxFn(canvasHeight);\r\n\r\n\t\t\t\tthat.avatarSize = that.pc2pxFn(avatarSize);\r\n\r\n\t\t\t\tthat.codeSize = that.pc2pxFn(codeSize);\r\n\t\t\t\tthat.codeX = that.pc2pxFn(codeX);\r\n\t\t\t\tthat.codeY = that.pc2pxFn(codeY);\r\n\r\n\t\t\t\tthat.goodsImgX = that.pc2pxFn(goodsImgX);\r\n\t\t\t\tthat.goodsImgY = that.pc2pxFn(goodsImgY);\r\n\t\t\t\tthat.goodsSize = that.pc2pxFn(goodsSize);\r\n\r\n\t\t\t\tthat.showImgW = that.pc2pxFn(showImgW);\r\n\t\t\t\tthat.showImgH = that.pc2pxFn(showImgH);\r\n\r\n\t\t\t\tlet imgIndex = that.imgIndex;\r\n\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t' 打印 canvas宽高 that.canvasBgWidth,that.canvasBgHeight',\r\n\t\t\t\t\tthat.canvasBgWidth,\r\n\t\t\t\t\tthat.canvasBgHeight\r\n\t\t\t\t);\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t二维码图片\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t${shareCodeImgHttpSrc.result}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t-------------------\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t头像\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t${avatarSrc}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t-------------------\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t背景图\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t${gbImgSrc}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t-------------------\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t商品图片\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t${imgArr[imgIndex]}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t-------------------\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t`\r\n\t\t\t\t);\r\n\r\n\t\t\t\tPromise.all([\r\n\t\t\t\t\turl2temPath(shareCodeImgHttpSrc.result),\r\n\t\t\t\t\turl2temPath(avatarSrc),\r\n\t\t\t\t\turl2temPath(gbImgSrc),\r\n\t\t\t\t\turl2temPath(imgArr[imgIndex - 1])\r\n\t\t\t\t])\r\n\t\t\t\t\t.then(temPathArr => {\r\n\t\t\t\t\t\t//初始二维码    //头像    //背景图片\r\n\t\t\t\t\t\tthat.temPathArr.code = temPathArr[0].result;\r\n\t\t\t\t\t\tthat.temPathArr.avatar = temPathArr[1].result;\r\n\t\t\t\t\t\tthat.temPathArr.bg = temPathArr[2].result;\r\n\t\t\t\t\t\tthat.temPathArr.currentImg = temPathArr[3].result;\r\n\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\tthat.temPathArr,\r\n\t\t\t\t\t\t\t'拿到三个临时路径',\r\n\t\t\t\t\t\t\t'\\n',\r\n\t\t\t\t\t\t\tthat.temPathArr.code,\r\n\t\t\t\t\t\t\tthat.temPathArr.avatar,\r\n\t\t\t\t\t\t\tthat.temPathArr.bg,\r\n\t\t\t\t\t\t\tthat.temPathArr.currentImg\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tthat.clipArcAvatarFn();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(e => {\r\n\t\t\t\t\t\tconsole.log(e, 'catch __err', '\\n');\r\n\t\t\t\t\t\tthat.failFn({\r\n\t\t\t\t\t\t\tmsg: e.msg + 'catch'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\tshareCodeImgHttpSrc.result,\r\n\t\t\t\t\t'--',\r\n\t\t\t\t\tavatarSrc,\r\n\t\t\t\t\t'--',\r\n\t\t\t\t\tgbImgSrc,\r\n\t\t\t\t\t'--',\r\n\t\t\t\t\timgArr[imgIndex - 1],\r\n\t\t\t\t\t'--'\r\n\t\t\t\t);\r\n\r\n\t\t\t\tconsole.log();\r\n\t\t\t} else {\r\n\t\t\t\tthat.failFn({\r\n\t\t\t\t\tmsg: shareCodeImgHttpSrc.msg\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 设计稿750px 转 实际手机屏幕比例px\r\n\t\tpc2pxFn(px) {\r\n\t\t\treturn (transNumFn(px) * this.windowWidth) / 750;\r\n\t\t},\r\n\t\t// 安卓app分享\r\n\t\tshareAppPageFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tlet pageTypeObj = {};\r\n\t\t\tif (that.isRob) {\r\n\t\t\t\tpageTypeObj.pageTypeRob = true;\r\n\t\t\t}\r\n\t\t\tthat.shareAppFn({\r\n\t\t\t\tpath: that.path,\r\n\t\t\t\tquery: {\r\n\t\t\t\t\tscene: true, // 如果登录就带着自己的加密字符串\r\n\t\t\t\t\tgoods_id: that.goodsId,\r\n\t\t\t\t\t...pageTypeObj\r\n\t\t\t\t},\r\n\t\t\t\toptions: {\r\n\t\t\t\t\ttitle: that.goodsName,\r\n\t\t\t\t\timageUrl: that.goodsImgs[that.imgIndex]\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 关闭 是否打开设置 的提示模态框\r\n\t\tcloneSettingFn() {\r\n\t\t\tthis.isShowOpenSetting = false;\r\n\t\t},\r\n\t\t// 关闭 带分享带二维码海报 的模态框\r\n\t\tcloneModuleFn() {\r\n\t\t\tthis.isShowModule = false;\r\n\t\t},\r\n\t\t// 失败的函数 提示\r\n\t\tfailFn(failMsg) {\r\n\t\t\tuni.hideLoading();\r\n\t\t\tuni.showToast({\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\ttitle: failMsg.msg\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// 返回 获取二维码图片的 网络地址  二维码图片内容是 当前食品和分享人的信息\r\n\t\tgetShareCodeImgFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tlet id = that.goodsId;\r\n\t\t\tlet { path, isRob } = that;\r\n\t\t\tconsole.log('id, path, isRob', id, path, isRob);\r\n\r\n\t\t\treturn new Promise(async (resFn, rejFn) => {\r\n\t\t\t\tlet result = await that.$request({\r\n\t\t\t\t\turl: '/api/Share/xcxImg_goods',\r\n\t\t\t\t\tmethod: 'post',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tpath,\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tisRob\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (result.statusCode == 200) {\r\n\t\t\t\t\tif (result.data.code == 200) {\r\n\t\t\t\t\t\tresFn({\r\n\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\tmsg: '获取分享二维码图片成功',\r\n\t\t\t\t\t\t\tresult: result.data.data\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trejFn({\r\n\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\tmsg: result.data.msg,\r\n\t\t\t\t\t\t\tresult: result.data.msg\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\trejFn({\r\n\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\tmsg: that.$errorMsg,\r\n\t\t\t\t\t\tresult: that.$errorMsg\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 剪切头像 成圆形\r\n\t\tasync clipArcAvatarFn() {\r\n\t\t\tlet that = this;\r\n\t\t\t// 创建画布对象\r\n\t\t\tlet ctx = uni.createCanvasContext('avatarCanvas', that);\r\n\r\n\t\t\t// 根据 图片的大小 绘制底图 的大小\r\n\t\t\tlet imgW = that.avatarSize,\r\n\t\t\t\timgH = that.avatarSize,\r\n\t\t\t\timgPath = that.temPathArr.avatar;\r\n\r\n\t\t\tctx.save();\r\n\t\t\tctx.arc(imgW / 2, imgH / 2, imgW / 2, 0, 2 * Math.PI); //绘制圆形\r\n\t\t\tctx.setStrokeStyle('rgba(0,0,0,0)');\r\n\t\t\tctx.stroke(); //这个一定要有，不然图片不剪切，我就是遇到了这个问题\r\n\t\t\tctx.clip(); //剪切\r\n\t\t\tctx.drawImage(imgPath, 0, 0, imgW, imgH); //置入图片\r\n\t\t\tctx.restore(); //恢复之前保存的绘图上下文\r\n\r\n\t\t\tconsole.log('// 剪切头像 成圆形', '\\n', ctx, ctx.draw);\r\n\r\n\t\t\tconsole.log(imgPath, 0, 0, imgW, imgH, '', '\\n');\r\n\r\n\t\t\tctx.draw(true, () => {\r\n\t\t\t\tconsole.log('//保存画布上的东西 画完后执行回调', '\\n');\r\n\t\t\t\t//保存画布上的东西 画完后执行回调\r\n\t\t\t\tthat.saveAvatarFn();\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 保存圆形头像地址\r\n\t\tsaveAvatarFn() {\r\n\t\t\tlet that = this;\r\n\t\t\t// 拿到拼合好的图片\r\n\t\t\tuni.canvasToTempFilePath(\r\n\t\t\t\t{\r\n\t\t\t\t\tcanvasId: 'avatarCanvas',\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tlet tempFilePath = res.tempFilePath;\r\n\r\n\t\t\t\t\t\tthat.temPathArr.avatarCode = tempFilePath;\r\n\r\n\t\t\t\t\t\tconsole.log('保存完圆形头像的临时路径开始 画最终分享图', '\\n');\r\n\t\t\t\t\t\tthat.createSharImgFn();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\tthat.failFn({\r\n\t\t\t\t\t\t\tmsg: '获取圆形头像路径失败'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tthat\r\n\t\t\t);\r\n\t\t},\r\n\t\t// 生成分享图片\r\n\t\tasync createSharImgFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tlet bgImgSrc = that.temPathArr.bg;\r\n\r\n\t\t\t// 创建画布对象\r\n\t\t\tlet ctx = uni.createCanvasContext('sharImgCanvas', that);\r\n\t\t\t// 获取图片信息，要按照原图来绘制，否则图片会变形\r\n\r\n\t\t\t// 根据 图片的大小 绘制底图 的大小\r\n\t\t\tlet imgW = that.canvasBgWidth,\r\n\t\t\t\timgH = that.canvasBgHeight,\r\n\t\t\t\timgPath = bgImgSrc;\r\n\r\n\t\t\t// 绘制底图 用原图的宽高比绘制(画背景)\r\n\t\t\tctx.drawImage(imgPath, 0, 0, imgW, imgH);\r\n\t\t\t(() => {\r\n\t\t\t\t// 画二维码\r\n\t\t\t\t// 根据 图片的大小 绘制底图 的大小\r\n\t\t\t\tlet imgW = that.codeSize,\r\n\t\t\t\t\timgH = that.codeSize,\r\n\t\t\t\t\timgPath = that.temPathArr.code;\r\n\r\n\t\t\t\tctx.drawImage(imgPath, that.codeX, that.codeY, imgW, imgH);\r\n\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\t// 画圆形头像\r\n\r\n\t\t\t\tlet { avatarSize, avatarX, avatarY } = that.getAvatarInfo();\r\n\r\n\t\t\t\tctx.arc(avatarX, avatarY, avatarSize / 2, 0, 2 * Math.PI);\r\n\t\t\t\tctx.setFillStyle('#ffffff');\r\n\t\t\t\tctx.fill();\r\n\r\n\t\t\t\tctx.drawImage(\r\n\t\t\t\t\tthat.temPathArr.avatarCode,\r\n\t\t\t\t\tavatarX - avatarSize / 2,\r\n\t\t\t\t\tavatarY - avatarSize / 2,\r\n\t\t\t\t\tavatarSize,\r\n\t\t\t\t\tavatarSize\r\n\t\t\t\t);\r\n\r\n\t\t\t\t(() => {\r\n\t\t\t\t\t// 画商品图\r\n\t\t\t\t\tlet imgW = that.goodsSize,\r\n\t\t\t\t\t\timgH = that.goodsSize,\r\n\t\t\t\t\t\timgPath = that.temPathArr.currentImg;\r\n\r\n\t\t\t\t\tctx.drawImage(imgPath, that.goodsImgX, that.goodsImgY, imgW, imgH);\r\n\r\n\t\t\t\t\tctx.setFontSize(20);\r\n\t\t\t\t\tctx.setFillStyle('#323232');\r\n\r\n\t\t\t\t\tlet goodsNameArr = getTextListFn(that.goodsName);\r\n\r\n\t\t\t\t\tconsole.log('商品名字信息', that.goodsName, '\\n', '切割处理的商品名字数组', goodsNameArr, '\\n');\r\n\r\n\t\t\t\t\tif (goodsNameArr.length >= 3) {\r\n\t\t\t\t\t\tgoodsNameArr[1] += '...';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet goodsNameTop = 940,\r\n\t\t\t\t\t\tgoodsNameLineHeight = 44;\r\n\r\n\t\t\t\t\tgoodsNameArr.forEach((item, index) => {\r\n\t\t\t\t\t\tif (index <= 1) {\r\n\t\t\t\t\t\t\tctx.fillText(\r\n\t\t\t\t\t\t\t\titem,\r\n\t\t\t\t\t\t\t\tthat.pc2pxFn(60),\r\n\t\t\t\t\t\t\t\tthat.pc2pxFn(index * goodsNameLineHeight + goodsNameTop)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t// ctx.fillText(item, 60, 60);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tlet priceText = '';\r\n\t\t\t\t\tif (that.goodsType == 'pintuan') {\r\n\t\t\t\t\t\tpriceText = `¥${that.goodsPrice}`;\r\n\t\t\t\t\t} else if (that.goodsType == 'jifen') {\r\n\t\t\t\t\t\tpriceText = `${that.goodsPrice}积分`;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpriceText = `¥${that.goodsPrice}`;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctx.setFontSize(16);\r\n\t\t\t\t\tctx.setFillStyle('#ea3a37');\r\n\t\t\t\t\tctx.fillText(priceText, that.pc2pxFn(60), that.pc2pxFn(3 * goodsNameLineHeight + goodsNameTop));\r\n\r\n\t\t\t\t\tctx.draw(true, () => {\r\n\t\t\t\t\t\tthat.showShareImgFn();\r\n\t\t\t\t\t});\r\n\t\t\t\t})();\r\n\t\t\t})();\r\n\t\t},\r\n\t\t// 获取头像尺寸坐标信息\r\n\t\tgetAvatarInfo() {\r\n\t\t\tlet that = this;\r\n\t\t\tlet avatarSize = parseInt((that.codeSize * 192) / 430), //头像尺寸\r\n\t\t\t\tavatarMargin = (that.codeSize - avatarSize) / 2, //头像距离二维码图片边框的边界距离\r\n\t\t\t\tavatarX = avatarMargin + that.codeX + avatarSize / 2, //头像在整个画布上的距离X\r\n\t\t\t\tavatarY = avatarMargin + that.codeY + avatarSize / 2; //头像在整个画布上的距离Y\r\n\t\t\treturn {\r\n\t\t\t\tavatarSize,\r\n\t\t\t\tavatarX,\r\n\t\t\t\tavatarY\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t// canvas画完后 展示最后的分享图片\r\n\t\tshowShareImgFn() {\r\n\t\t\tlet that = this;\r\n\t\t\t// 拿到拼合好的图片\r\n\t\t\tuni.canvasToTempFilePath(\r\n\t\t\t\t{\r\n\t\t\t\t\tcanvasId: 'sharImgCanvas',\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tlet tempFilePath = res.tempFilePath;\r\n\r\n\t\t\t\t\t\tthat.shareImgPath = tempFilePath;\r\n\r\n\t\t\t\t\t\tconsole.log(that.shareImgPath, '最终的图片路径——', '\\n');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\tthat.failFn({\r\n\t\t\t\t\t\t\tmsg: '保存失败稍后重试'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tthat\r\n\t\t\t);\r\n\t\t},\r\n\t\t// 点击保存图片按钮\r\n\t\tsaveShearImgFn() {\r\n\t\t\tlet that = this;\r\n\t\t\tconsole.log('打印生成的图片路径 that.shareImgPath', that.shareImgPath);\r\n\t\t\tif (!that.shareImgPath) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\tthat.saveImgFn(that.shareImgPath);\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\tthat.saveImgAppFn(that.shareImgPath);\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\t// 保存图片函数\r\n\t\tasync saveImgFn(src) {\r\n\t\t\tlet that = this;\r\n\t\t\t// 获取权限列表的信息\r\n\t\t\tlet settingInfo = await that.settingInfoFn('scope.writePhotosAlbum');\r\n\t\t\tconsole.log(settingInfo, '获取权限列表的信息', '\\n');\r\n\r\n\t\t\tif (settingInfo.type == 'success') {\r\n\t\t\t\t// 如果用户 授权 了 并且 授权 状态是 禁止的 状态\r\n\t\t\t\tif (settingInfo.isOk == false && settingInfo.isFirst == false) {\r\n\t\t\t\t\t// 打开权限列表 让用户打开该状态\r\n\t\t\t\t\t// that.openSettingFn('scope.writePhotosAlbum');\r\n\r\n\t\t\t\t\tthat.isShowOpenSetting = true;\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\twx.openSetting({\r\n\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\tconsole.log(res.authSetting);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t */\r\n\t\t\t\t}\r\n\t\t\t\t// 如果是第一次使用该 权限 或者 该权限已通过 正常调用函数\r\n\t\t\t\tif (settingInfo.isFirst || settingInfo.isOk) {\r\n\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\tsrc: src,\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tuni.saveImageToPhotosAlbum({\r\n\t\t\t\t\t\t\t\tfilePath: res.path,\r\n\t\t\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\t\ttitle: '保存成功'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\ttitle: '保存失败'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(e) {\r\n\t\t\t\t\t\t\tconsole.log('获取图片信息错误', e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\ttitle: settingInfo.msg\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 安卓app 下载图片\r\n\t\tasync saveImgAppFn(src) {\r\n\t\t\tuni.getImageInfo({\r\n\t\t\t\tsrc: src,\r\n\t\t\t\tsuccess(res) {\r\n\t\t\t\t\tuni.saveImageToPhotosAlbum({\r\n\t\t\t\t\t\tfilePath: res.path,\r\n\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\ttitle: '保存成功'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\ttitle: '保存失败'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail(e) {\r\n\t\t\t\t\tconsole.log('获取图片信息错误', e);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState({\r\n\t\t\tuserInfoAvatar: store => store.userInfo.userInfoAvatar, // 头像地址\r\n\t\t\tuserInfoEncrypt: store => store.userInfo.userInfoEncrypt, // 加密字符串\r\n\t\t})\r\n\t}\r\n\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.share-code-wrap {\r\n\twidth: 60rpx;\r\n\theight: 60rpx;\r\n}\r\n.bg-module {\r\n\tposition: fixed;\r\n\tz-index: 882;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\twidth: 100vw;\r\n\theight: 100vh;\r\n\ttransition: 0.2s;\r\n\tbackground: rgba(0, 0, 0, 0.4);\r\n}\r\n\r\n.block-dom {\r\n\twidth: 100vw;\r\n\theight: 100vh;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tposition: fixed;\r\n\tz-index: 883;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\ttransition: 0.4s;\r\n\ttransform: translate3d(0, 150%, 0) scale(0.4);\r\n\topacity: 0;\r\n\r\n\t&.act {\r\n\t\ttransform: translate3d(0, 4px, 0) scale(1);\r\n\t\topacity: 1;\r\n\t}\r\n\r\n\t.img-wrap {\r\n\t\tflex: 1;\r\n\t\t@include flex-center;\r\n\t}\r\n\r\n\t.btn-group-block {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\twidth: 100vw;\r\n\t\theight: 256rpx;\r\n\t\tpadding: 0 60rpx;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 20rpx 20rpx 0 0;\r\n\r\n\t\t.icon-item {\r\n\t\t\tflex: 1;\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\theight: 130rpx;\r\n\t\t\tfont-size: 22rpx;\r\n\t\t\tcolor: #272727;\r\n\r\n\t\t\t.icon-block- {\r\n\t\t\t\t@include flex-center;\r\n\t\t\t\twidth: 80rpx;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tborder-radius: 50%;\r\n\t\t\t}\r\n\r\n\t\t\t.icon-weixin- {\r\n\t\t\t\tbackground: #6ccc4e;\r\n\t\t\t}\r\n\r\n\t\t\t.icon-load {\r\n\t\t\t\ttransform: rotate(180deg);\r\n\t\t\t\tbackground: #ffdb4f;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n@keyframes animate-rotate {\r\n\t0% {\r\n\t\ttransform: rotate(0deg);\r\n\t}\r\n\r\n\t100% {\r\n\t\ttransform: rotate(360deg);\r\n\t}\r\n}\r\n\r\n.loading-wrap {\r\n\tposition: relative;\r\n\twidth: 74rpx;\r\n\theight: 74rpx;\r\n\r\n\t.animate-rotate-dom {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tanimation: animate-rotate infinite 1.4s linear;\r\n\r\n\t\t.box {\r\n\t\t\tposition: absolute;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\r\n\t\t\t&.box1 {\r\n\t\t\t\ttransform: rotate(45deg);\r\n\t\t\t}\r\n\r\n\t\t\t&.box2 {\r\n\t\t\t\ttransform: rotate(0deg);\r\n\t\t\t}\r\n\r\n\t\t\t.dot {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\twidth: 16rpx;\r\n\t\t\t\theight: 16rpx;\r\n\t\t\t\tbackground: #ffffff;\r\n\t\t\t\tborder-radius: 50%;\r\n\t\t\t}\r\n\r\n\t\t\t.dot1 {\r\n\t\t\t\tleft: 0;\r\n\t\t\t\ttop: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.dot2 {\r\n\t\t\t\tright: 0;\r\n\t\t\t\ttop: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.dot3 {\r\n\t\t\t\tleft: 0;\r\n\t\t\t\tbottom: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.dot4 {\r\n\t\t\t\tright: 0;\r\n\t\t\t\tbottom: 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.text {\r\n\t\tposition: absolute;\r\n\t\tleft: 50%;\r\n\t\tbottom: 0;\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #ffffff;\r\n\t\twhite-space: nowrap;\r\n\t\ttransform: translate3d(-50%, 180%, 0);\r\n\t}\r\n}\r\n\r\n.btn-default {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\theight: 60rpx;\r\n\toverflow: hidden;\r\n\t.text {\r\n\t\tfont-size: 20rpx;\r\n\t\tcolor: #656565;\r\n\t}\r\n\t.share-icon_goods-info {\r\n\t\twidth: 30rpx;\r\n\t\theight: 30rpx;\r\n\t}\r\n}\r\n</style>\r\n","import mod from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share-code-img.vue?vue&type=style&index=0&id=19bebe3a&lang=scss&scoped=true&\"; export default mod; export * from \"-!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.6.9.20200403\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share-code-img.vue?vue&type=style&index=0&id=19bebe3a&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1675502588813\n      var cssReload = require(\"E:/HBuilderX.2.6.9.20200403/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}